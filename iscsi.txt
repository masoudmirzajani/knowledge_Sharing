***﻿Install iscsi targets and initiators***





**Install an Configur Targets  “Storage”:**

yum --enablerepo=epel -y install scsi-target-utils

mkdir /iscsi-disks
dd if=/dev/zero of=/iscsi-disks/disk01.img count=0 bs=1 seek=2G

vim /etc/tgt/targets.conf

<target iqn.2020-04.nfs.server:storage.target0>
backing-store  /iscssi-disk/disk01.img
initiator-address 192.168.122.5,172.16.68.1
incominguser masoud masoud
</target>

systemctl start tgtd
systemctl enable tgtd

tgtadm –mode target –op show





**Install and Configure initiator  “Client”:**

yum -y install iscsi-initiator-utils

vim /etc/iscsi/initiatorname.iscsi
InitiatorName=iqn.2020-04.nfs.server:storage.target0
vim /etc/iscsi/iscsid.conf
node.session.auth.authmethod = CHAP
node.session.auth.username = masoud
node.session.auth.password = masoud

iscsiadm -m discovery -t sendtargets -p “Target ip addr”
iscsiadm -m node -o show

iscsiadm -m node –login
or
iscsiadm -m node --targetname "iqn.2020-04.nfs.server:storage.target0" --portal "Target ip addr" –login

iscsiadm -m session -o show
cat /proc/partions
parted –script / dev/sd? “mklable lun01”
parted –script / dev/sd? “mkpart primary 0% 100%”
mkfs.xfs -l size=1024 -s size=4096 / dev/sd??
mount / dev/sd?? /mnt







